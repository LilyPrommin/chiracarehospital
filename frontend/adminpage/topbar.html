<div class="top">
  <nav>
    <div class="sidebar-button">
      <span id="page-title" class="text"></span> <!-- Placeholder for the page title -->
    </div>

    <div class="right-section" title="หน้าหลัก">
      <a href="../adminpage/notifications.html" class="icon-button">
        <i class='bx bx-bell'></i>
      </a>

      <div class="profile-details" onclick="goToProfilePage()">
        <img id="profile-image" alt="profile-details">
        <div class="admin_name">
          <div class="name" id="username">TEST</div>
          <div class="job" id="department">TEST</div>
        </div>
        <div class="tooltip">ดูรายละเอียดผู้ใช้</div>
      </div>
    </div>
  </nav>
</div>

<script>
  // ตรวจสอบว่าผู้ใช้ล็อกอินอยู่หรือไม่
  if (!localStorage.getItem('token')) {
    // ถ้ายังไม่ล็อกอิน ให้เปลี่ยนเส้นทางไปยังหน้า login
    window.location.href = "../login.html";
  } else {
    // ดึงข้อมูลผู้ใช้จาก localStorage
    const user = JSON.parse(localStorage.getItem('user'));

    // แสดงค่าใน console เพื่อดูว่าเก็บข้อมูลอะไรบ้าง
    console.log('User data from localStorage:', user);

    if (user) {
      // แสดงชื่อผู้ใช้
      document.getElementById('username').textContent = user.role;

      // แสดงพื้นที่รับผิดชอบ
      document.getElementById('department').textContent = user.full_name;

      // ตรวจสอบว่ามีรูปภาพผู้ใช้หรือไม่
      if (user.user_image) {
        document.getElementById('profile-image').src = `data:image/jpeg;base64,${user.user_image}`;
      } else {
        // ถ้าไม่มีรูปภาพ ให้ใช้รูปภาพเริ่มต้น
        document.getElementById('profile-image').src = 'assets/images/default_profile.png'; // รูปภาพเริ่มต้น
      }
    } else {
      console.error('User data is missing from localStorage');
    }
  }

  // ฟังก์ชันสำหรับไปยังหน้าโปรไฟล์
  function goToProfilePage() {
    window.location.href = '../profile.html';
  }
</script>